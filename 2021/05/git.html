<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="git 常用技巧" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="本文旨在介绍 git 的常用操作技巧，尽量覆盖常用使用场景，以充分利用 git 这个高效的代码管理 工具。" /><meta property="og:description" content="本文旨在介绍 git 的常用操作技巧，尽量覆盖常用使用场景，以充分利用 git 这个高效的代码管理 工具。" /><link rel="canonical" href="//code-winder.github.io/2021/05/git.html" /><meta property="og:url" content="//code-winder.github.io/2021/05/git.html" /><meta property="og:site_name" content="Code-Winder" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-29T16:10:52+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="git 常用技巧" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-05-29T16:10:52+08:00","datePublished":"2021-05-29T16:10:52+08:00","description":"本文旨在介绍 git 的常用操作技巧，尽量覆盖常用使用场景，以充分利用 git 这个高效的代码管理 工具。","headline":"git 常用技巧","mainEntityOfPage":{"@type":"WebPage","@id":"//code-winder.github.io/2021/05/git.html"},"url":"//code-winder.github.io/2021/05/git.html"}</script><title>git 常用技巧 | Code-Winder</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Code-Winder"><meta name="application-name" content="Code-Winder"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script> <script> // 百度统计代码 var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?e37ebacf05386ebe11672ab0dc609b69"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> <script> // google analytics (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '{site.google_analytics_id}}', 'auto'); ga('send', 'pageview'); </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/favicon.ico" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Code-Winder</a></div><div class="site-subtitle font-italic">灵感源于好奇</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/code-winder" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['414834682','qq.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <i class="fas fa-list-alt fa-fw" id="content-list"></i> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>git 常用技巧</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >X</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 class="title_class" data-toc-skip>git 常用技巧</h1><div id="label_center"><div class="label"><div class="label-card"></div><div class="label-card"> <span class="categories"> <i class="fa fa-th-list"></i> <a href="/categories/%E9%AB%98%E6%95%88%E5%B7%A5%E5%85%B7" title="Category: 高效工具" rel="category">高效工具</a> </span></div><div class="label-card"> <span class="pageTag"> <i class="fa fa-tags"></i> <a href="/tags/tool" title="Tag: Tool" rel="tag">Tool</a> </span></div></div></div><div class="post-meta text-muted"> <span> 发表于 <em class="" data-ts="1622275852" data-df="YYYY/MM/DD" data-toggle="tooltip" data-placement="bottom"> 2021/05/29 </em> </span><div class="d-flex justify-content-between"> <span> 作者 <em> <a href="https://github.com/code-winder">code-winder</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3441 字"> <em>19 分钟</em>阅读</span></div></div></div><div class="post-content"><blockquote><p>本文旨在介绍 git 的常用操作技巧，尽量覆盖常用使用场景，以充分利用 git 这个高效的代码管理 工具。</p></blockquote><ul id="markdown-toc"><li><a href="#获取帮助" id="markdown-toc-获取帮助">获取帮助</a><li><a href="#初始化-git-项目" id="markdown-toc-初始化-git-项目">初始化 git 项目</a><ul><li><a href="#设置常用配置" id="markdown-toc-设置常用配置">设置常用配置</a><li><a href="#项目初始化" id="markdown-toc-项目初始化">项目初始化</a></ul><li><a href="#修改了些什么" id="markdown-toc-修改了些什么">修改了些什么？</a><ul><li><a href="#提交前改了啥" id="markdown-toc-提交前改了啥">提交前改了啥</a><li><a href="#提交之后的某个版本改了啥" id="markdown-toc-提交之后的某个版本改了啥">提交之后的某个版本改了啥</a><li><a href="#分支合并前改了啥" id="markdown-toc-分支合并前改了啥">分支合并前改了啥</a><li><a href="#丢弃修改" id="markdown-toc-丢弃修改">丢弃修改</a></ul><li><a href="#优化提交记录" id="markdown-toc-优化提交记录">优化提交记录</a><ul><li><a href="#修改注释信息" id="markdown-toc-修改注释信息">修改注释信息</a><li><a href="#合并提交记录" id="markdown-toc-合并提交记录">合并提交记录</a></ul><li><a href="#多分支处理" id="markdown-toc-多分支处理">多分支处理</a><ul><li><a href="#打补丁" id="markdown-toc-打补丁">打补丁</a><ul><li><a href="#合并部分文件" id="markdown-toc-合并部分文件">合并部分文件</a><li><a href="#分支打补丁" id="markdown-toc-分支打补丁">分支打补丁</a></ul><li><a href="#合并分支" id="markdown-toc-合并分支">合并分支</a><li><a href="#新建分支" id="markdown-toc-新建分支">新建分支</a><ul><li><a href="#新建本地分支" id="markdown-toc-新建本地分支">新建本地分支：</a><li><a href="#新建远程分支" id="markdown-toc-新建远程分支">新建远程分支</a></ul><li><a href="#查看分支" id="markdown-toc-查看分支">查看分支</a><li><a href="#删除或更新分支" id="markdown-toc-删除或更新分支">删除或更新分支</a><li><a href="#切换分支" id="markdown-toc-切换分支">切换分支</a><li><a href="#打-tag" id="markdown-toc-打-tag">打 tag</a></ul><li><a href="#其他" id="markdown-toc-其他">其他</a></ul><h1 id="获取帮助">获取帮助</h1><p>在终端使用 <code class="language-plaintext highlighter-rouge">man git-子命令</code> 的形式获取帮助。如 <code class="language-plaintext highlighter-rouge">man git-commit</code>、<code class="language-plaintext highlighter-rouge">man git-pull</code></p><h1 id="初始化-git-项目">初始化 git 项目</h1><h2 id="设置常用配置"><span class="mr-2">设置常用配置</span><a href="#设置常用配置" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>全局用户名：<code class="language-plaintext highlighter-rouge">git config --global user.name "your_name"</code><li>全局邮箱：<code class="language-plaintext highlighter-rouge">git config --global user.email "you@example.com"</code><li>配置命令别名：如 <code class="language-plaintext highlighter-rouge">git config --global alias.co checkout</code><li>删除命令别名：如 <code class="language-plaintext highlighter-rouge">git config --global --unset alias.co</code><li>查看系统配置：<code class="language-plaintext highlighter-rouge">git config --list</code><li>查看用户配置：<code class="language-plaintext highlighter-rouge">cat ~/.gitconfig</code><li>查看暂存区配置：<code class="language-plaintext highlighter-rouge">cat ~/.gitconfig</code><li>查看当前项目配置：<code class="language-plaintext highlighter-rouge">cat .git/config</code><li>修改默认编辑器：如 <code class="language-plaintext highlighter-rouge">git config –global core.editor vim</code> ，这样你就可以使用自己熟悉的编辑器 进行 git 的一些交互命令操作<li>绑定多个远程仓库：git push 的时候可以同时更新多个仓库<ul><li><code class="language-plaintext highlighter-rouge">git remote set-url --add origin https://github.com/ShengChangJian/ShengChangJian.github.io.git</code><li><code class="language-plaintext highlighter-rouge">git remote set-url --add origin https://gitee.com/shengchangjian/ShengChangJian.git</code></ul></ul><h2 id="项目初始化"><span class="mr-2">项目初始化</span><a href="#项目初始化" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>git 初始化，进入项目文件夹：</p><ul><li><code class="language-plaintext highlighter-rouge">git init</code><li><code class="language-plaintext highlighter-rouge">git add .</code><li><code class="language-plaintext highlighter-rouge">git commit -m "这次做了些啥"</code><li><code class="language-plaintext highlighter-rouge">git push</code></ul><h1 id="修改了些什么">修改了些什么？</h1><p>建议每次开发或修 bug 的时候自己单独新建一个本地分支和远程分支，等合并本次开发或 bug 修复所有提交记录后， 在测试没有问题之后再合并到主分支中去。如此可以省去很多麻烦，也可以降低很多风险。</p><p>想知道你刚才修改了些什么，历史上修改了些什么吗？ 以下命令会告诉你答案。</p><h2 id="提交前改了啥"><span class="mr-2">提交前改了啥</span><a href="#提交前改了啥" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>提交前确认一下这次到底改了些什么之后再提交会安心很多！</p><ul><li><code class="language-plaintext highlighter-rouge">git status</code>：显示修改过的文件列表<li><code class="language-plaintext highlighter-rouge">git diff</code>：未 add 时的文件变化情况（命令后可接具体的文件等）<li><code class="language-plaintext highlighter-rouge">git diff --cached</code>：在 add 之后 commit 之前文件变化情况（命令后可接具体的文件等）<li><code class="language-plaintext highlighter-rouge">git diff HEAD</code>：在 commit 前文件变化情况（前两条命令和合并）<li><code class="language-plaintext highlighter-rouge">git diff --staged</code>：有时候修改了不想 commit 又要切换分支，会使用 stage 命令，此后可以用该 diff 命令 列出到底 stage 了些什么内容。</ul><p>以上命令都可以指定版本、分支或具体文件，以聚焦自己感兴趣的内容</p><h2 id="提交之后的某个版本改了啥"><span class="mr-2">提交之后的某个版本改了啥</span><a href="#提交之后的某个版本改了啥" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><code class="language-plaintext highlighter-rouge">git log</code>：提交的历史记录<li><code class="language-plaintext highlighter-rouge">git log --oneline</code>：简化 log 显示<li><code class="language-plaintext highlighter-rouge">git log --stat</code>：输出 log 的统计信息<li><code class="language-plaintext highlighter-rouge">git log -p</code>：输出修改的具体内容<li><code class="language-plaintext highlighter-rouge">git log --author=作者</code>：指定显示某个作者的提交记录<li><code class="language-plaintext highlighter-rouge">git diff 版本1 版本2</code>：列出相同分支两个版本之间的差异，这个在 rebase 多个提交时可以提供参考<li><code class="language-plaintext highlighter-rouge">git blame 文件</code>：追踪是谁改了哪些代码</ul><p>以上命令都可以指定版本或具体文件，以聚焦自己感兴趣的内容</p><h2 id="分支合并前改了啥"><span class="mr-2">分支合并前改了啥</span><a href="#分支合并前改了啥" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><code class="language-plaintext highlighter-rouge">git log --left-right dev...master</code>：查看两个分支提交记录的不同处，主要用于合并分支前<li><code class="language-plaintext highlighter-rouge">git diff 分支1 分支2</code>：列出两个分支最近不同的详细信息<li><code class="language-plaintext highlighter-rouge">git diff 分支1...分支2</code>：列出两个分支所有不同的详细信息<li><code class="language-plaintext highlighter-rouge">git diff 分支1 分支2 --stat</code>：列出两个分支的不同点的统计信息</ul><h2 id="丢弃修改"><span class="mr-2">丢弃修改</span><a href="#丢弃修改" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>改了很多，发现有问题或者不再需要时，往往会取消修改或回滚版本。在执行以下命令前强烈 建议先使用 <code class="language-plaintext highlighter-rouge">git stash</code> 保留快照，以便想挽回时使用 <code class="language-plaintext highlighter-rouge">git stash pop</code> 恢复。</p><ul><li>未 add 时：<code class="language-plaintext highlighter-rouge">git checkout -- fileName</code> 回到最近一次提交或add时的状态<li>已 add 未 commit 时：<code class="language-plaintext highlighter-rouge">get reset HEAD -- fileName</code><li>已提交时：可以有以下处理方式<ul><li>抹掉刚错误提交的版本（不推荐）：<code class="language-plaintext highlighter-rouge">git reset --hard 需要到达的版本</code>，然后强制推送到远程仓库 <code class="language-plaintext highlighter-rouge">git push -f -u origin 分支名称</code><li>不回退版本，而是形成新的版本（推荐）：<code class="language-plaintext highlighter-rouge">git revert -n 想要的版本</code>，然后 <code class="language-plaintext highlighter-rouge">git commit -m "做了些啥"</code>，最后 <code class="language-plaintext highlighter-rouge">git push</code></ul></ul><h1 id="优化提交记录">优化提交记录</h1><p>理想的提交记录状态是：每次提交都能实现一个相对完整的功能、需求或修复相对独立的bug；每次提交的 内容描述都能恰到好处地概述代码修改。可惜的是，我们往往因为某种原因会很随意地填写 commit，然后 就提交了。此后，其他人甚至提交着过了一段时间之后也不知道该提交到底做了些什么。如此下去，git log 的 查看提交流水时也无法清楚地知道其中的脉络。万一要回退到某次提交也无从下手。</p><p>为优化提交记录，我们需要修改提交的描述或者合并几个紧密相关的版本。</p><h2 id="修改注释信息"><span class="mr-2">修改注释信息</span><a href="#修改注释信息" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>建议每次开发或修bug的时候自己单独新建一个本地分支和远程分支，等合并本次开发或bug修复所有提交记录后， 在测试没有问题之后再合并到主分支中去。如此可以省去很多麻烦，也可以降低很多风险。</p><ul><li>先本地备份分支：<code class="language-plaintext highlighter-rouge">git checkout -b 新的分支名</code>，如此备份分支之后，在后面的操作中一旦失误，还可以想办法 恢复<li>回到原分支： <code class="language-plaintext highlighter-rouge">git checkout 原分支</code></ul><p>修改注释信息，至少有以下两种情景：</p><ul><li>修改最近一次的注释信息：<code class="language-plaintext highlighter-rouge">git commit --amend -m "新的描述"</code><li>修改某次提交的注释信息：<ul><li><code class="language-plaintext highlighter-rouge">git -i 需要修改的版本</code>，在该版本前把 pick 改成 reword，然后保存<li>根据提示操作即可</ul></ul><h2 id="合并提交记录"><span class="mr-2">合并提交记录</span><a href="#合并提交记录" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>建议每次开发或修 bug 的时候自己单独新建一个本地分支和远程分支，等合并本次开发或 bug 修复所有提交记录后， 在测试没有问题之后再合并到主分支中去。如此可以省去很多麻烦，也可以降低很多风险。</p><ul><li>先本地备份分支：<code class="language-plaintext highlighter-rouge">git checkout -b 新的分支名</code>，如此备份分支之后，在后面的操作中一旦失误，还可以想办法 恢复<li>回到原分支： <code class="language-plaintext highlighter-rouge">git checkout 原分支</code></ul><p>合并提交记录，至少有以下两种情景：</p><ul><li>合并[当前最新, 某个版本)：<ul><li><code class="language-plaintext highlighter-rouge">git rebase -i bddesdd6</code> #要合并的提交(bddebfb1)的上一条提交ID<li>在打开的编辑器中，只留下最上面一行为 pick，其他非注释行改为 f，如<ul><li>pick bddebfb1 退出修改<li>f 68326b8c 接口修改<li>f 699501f7 接口修改<li>f 784e86b3 接口修改</ul></ul><li>合并中间的某几个版本：同上，只是把中间的版本由 pick 改为 f</ul><p>修改之后，要确认修改了些什么，可以 <code class="language-plaintext highlighter-rouge">git log</code>，没问题再 <code class="language-plaintext highlighter-rouge">git push origin 分支名 -f</code>（<strong>确保此分支没有别的提交或者只有你在用</strong>）。 如果出现错误提示， 很有可能该分支启用了分支保护，不允许使用 -f，只要暂时去掉这层保护即可。</p><h1 id="多分支处理">多分支处理</h1><h2 id="打补丁"><span class="mr-2">打补丁</span><a href="#打补丁" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>只是想应用某个分支的某些文件的修改，而不是全部，则可以使用打补丁的方式在提示中合并应用部分代码。</p><h3 id="合并部分文件"><span class="mr-2">合并部分文件</span><a href="#合并部分文件" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>这里假设要把分支 test1_branch 中的 test_file.txt 合并到分支 master 中的相应文件，则可以：</p><ul><li><code class="language-plaintext highlighter-rouge">git checkout master</code><li><code class="language-plaintext highlighter-rouge">git checkout --patch test1_branch test_file.txt</code><li>然后根据提示一步步操作即可</ul><h3 id="分支打补丁"><span class="mr-2">分支打补丁</span><a href="#分支打补丁" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>正常情况下，对于本地分支，我们可以直接 <code class="language-plaintext highlighter-rouge">git merge</code> 就行，然后提交就行。但是，在有些情况下需要代码审核通过之后才能提交，或者 对于某个分支你没有提交权限，此时就需要把补丁文件发送给有权限操作的人去使用这些补丁。</p><p>假设你在 fix_branch 分支中 commit 了多次，和 master 分支存在了多个不同的地方，那么，可以通过以下流程对 master 打补丁，以应用 fix_branch 中的修改。</p><ul><li><code class="language-plaintext highlighter-rouge">git checkout fix_branch</code><li><code class="language-plaintext highlighter-rouge">git format-patch -M master</code><li>然后在终端 ls 一下就可以看到 patch 文件（每次提交会生成一个补丁文件）<li>把这些补丁文件复制到其他地方或者打包发邮件给打补丁的人</ul><p>生成好了补丁之后，就可以打补丁了。</p><ul><li><code class="language-plaintext highlighter-rouge">git checkout master</code><li><code class="language-plaintext highlighter-rouge">git apply --reject</code> 所有的补丁文件（可以使用通配符）<li>如果有冲突，就根据生成的 rej 文件手动解决冲突，然后删掉相应的 rej 文件<li>解决好所有冲突之后，使用 <code class="language-plaintext highlighter-rouge">git add</code> 应用修改<li>最后使用 <code class="language-plaintext highlighter-rouge">git am --resolved</code> 告诉 git 打补丁结束</ul><h2 id="合并分支"><span class="mr-2">合并分支</span><a href="#合并分支" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>在独享的分支中完成开发胡log优化后需要合并到主分支，此时如果主分支已经有其他人做了新的提交，我们 需要先把主分支合并到独享分支，解决冲突后再合并到主分支中去。为此，至少有以下几种方式：</p><ul><li>变基 rebase：<ul><li>更新 master 分支： <code class="language-plaintext highlighter-rouge">git checkout master</code> 然后 <code class="language-plaintext highlighter-rouge">git branch</code> 查看当前分支，如果已经切换到 master 分支， 最后 <code class="language-plaintext highlighter-rouge">git pull</code> 更新<li>回到独享分支：<code class="language-plaintext highlighter-rouge">git checkout 独享分支</code><li>在独享分支中执行 <code class="language-plaintext highlighter-rouge">git rebase master</code> 合并主分支，解决冲突<li><code class="language-plaintext highlighter-rouge">git status</code> 查看，然后 <code class="language-plaintext highlighter-rouge">git add 对应文件</code> 或者 <code class="language-plaintext highlighter-rouge">git add -u</code><li><code class="language-plaintext highlighter-rouge">git rebase --continue</code> 继续解决剩下的冲突，如果想终止变基，可以 <code class="language-plaintext highlighter-rouge">git rebase --abort</code></ul><li>使用 merge：<ul><li>更新 master 分支： <code class="language-plaintext highlighter-rouge">git checkout master</code> 然后 <code class="language-plaintext highlighter-rouge">git branch</code> 查看当前分支，如果已经切换到 master 分支， 最后 <code class="language-plaintext highlighter-rouge">git pull</code> 更新<li>回到独享分支：<code class="language-plaintext highlighter-rouge">git checkout</code> 独享分支<li>在独享分支中执行 <code class="language-plaintext highlighter-rouge">git merge master</code><li>解决所有冲突之后再提交</ul></ul><h2 id="新建分支"><span class="mr-2">新建分支</span><a href="#新建分支" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="新建本地分支"><span class="mr-2">新建本地分支：</span><a href="#新建本地分支" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>clone 主分支： <code class="language-plaintext highlighter-rouge">git clone --recurse-submodules URL</code><li>checkout 新分支：<ul><li>基于当前分支：<code class="language-plaintext highlighter-rouge">git checkout -b 本地新分支</code><li>基于当前分支的某个版本：<code class="language-plaintext highlighter-rouge">git checkout -b 版本号</code><li>基于远程分支：<code class="language-plaintext highlighter-rouge">git checkout -b 本地新分支 origin/远程分支</code></ul></ul><h3 id="新建远程分支"><span class="mr-2">新建远程分支</span><a href="#新建远程分支" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>新建本地分支后，使用 <code class="language-plaintext highlighter-rouge">git push origin 本地分支:远程分支</code> 即可创建远程分支。</p><h2 id="查看分支"><span class="mr-2">查看分支</span><a href="#查看分支" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>当前分支： <code class="language-plaintext highlighter-rouge">git branch</code><li>已经合并到当前分支的分支：<code class="language-plaintext highlighter-rouge">git branch --merged</code><li>还没有合并到当前分支的分支：<code class="language-plaintext highlighter-rouge">git branch --no-merged</code><li>所有分支： <code class="language-plaintext highlighter-rouge">git branch -a</code></ul><h2 id="删除或更新分支"><span class="mr-2">删除或更新分支</span><a href="#删除或更新分支" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>删除本地分支：<code class="language-plaintext highlighter-rouge">git branch -d 分支</code> 或强制 <code class="language-plaintext highlighter-rouge">git branch -D 本地分支</code><li>删除远程分支：<code class="language-plaintext highlighter-rouge">git push origin :远程分支</code><li>从远程分支更新本地分支：<code class="language-plaintext highlighter-rouge">git pull origin 远程分支</code> 或者 <code class="language-plaintext highlighter-rouge">git pull</code><li>从本地分支更新远程分支：<code class="language-plaintext highlighter-rouge">git push origin 远程分支</code> 或者 <code class="language-plaintext highlighter-rouge">git push</code><li>远程强行覆盖本地代码：<code class="language-plaintext highlighter-rouge">git fetch --all &amp;&amp; git reset --hard origin/master &amp;&amp; git pull</code></ul><h2 id="切换分支"><span class="mr-2">切换分支</span><a href="#切换分支" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>切换分支可以使用 <code class="language-plaintext highlighter-rouge">git checkout 分支</code>，当出现无法切换时，可以按照提示提交。</p><p>当改了一些东西之后发现分支不对，或者不应该在主分支改，此时肯定不能提交，只能新建分支。为此， 可以：</p><ul><li>使用 <code class="language-plaintext highlighter-rouge">git stash</code> 暂存<li>使用 <code class="language-plaintext highlighter-rouge">git checkout -b 新分支</code> 创建新分支<li>在新分支中使用 <code class="language-plaintext highlighter-rouge">git stash pop</code> 把修改应用到新的分支<li>使用 <code class="language-plaintext highlighter-rouge">git diff</code> 命令核实是否为自己想要的改动</ul><p><strong>注意</strong>：切换分支之前或之后开始编辑文件之前一定要关掉相关的编辑窗口，这样可以避免分支编辑混乱。</p><h2 id="打-tag"><span class="mr-2">打 tag</span><a href="#打-tag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>对于已经完成一个大的版本或者里程碑，需要定格时，在不想或不便于新建分支的情况下，可以打 tag。</p><ul><li><code class="language-plaintext highlighter-rouge">git tag</code> -a tagName -m “描述一下”：建立本地标签<li><code class="language-plaintext highlighter-rouge">git push origin tagName</code>：提送到远程仓库（也可以通过 <code class="language-plaintext highlighter-rouge">git push origin --tags</code> 把所有的标签都推送）</ul><p>其他常用的 tag 操作：</p><ul><li>git tag：列出本地当前分支的所有 tag<li>git tag -l v1.0.*：通过通配符显示特定的 tag<li>git show tagName：显示标签的详细信息<li>git tag -d tagName：本地删除标签 tagName<li>git push origin :refs/tags/tagName：删除远程 tag（应在删除本地 tag 之后）</ul><h1 id="其他">其他</h1><ul><li>不再跟着某个文件：<code class="language-plaintext highlighter-rouge">git rm --cached fileName</code> 执行该命令后, git不再跟踪fileName, 但是fileName文件仍保留<li>删除文件：<code class="language-plaintext highlighter-rouge">git rm -f fileName</code><li>负略某个文件或文件夹： <code class="language-plaintext highlighter-rouge">vim .gitignore</code> 编辑该文件，填入如 filename 或者 dir/</ul><h1 style="visibility: hidden;" id="want-cmm"> 我要评论</h1></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=git%20%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%20-%20Code-Winder&url=%2F%2Fcode-winder.github.io%2F2021%2F05%2Fgit.html" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=git%20%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%20-%20Code-Winder&u=%2F%2Fcode-winder.github.io%2F2021%2F05%2Fgit.html" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2F%2Fcode-winder.github.io%2F2021%2F05%2Fgit.html&text=git%20%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%20-%20Code-Winder" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">Cpp</a> <a class="post-tag" href="/tags/it-basic/">IT_Basic</a> <a class="post-tag" href="/tags/tool/">Tool</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/go/">Go</a> <a class="post-tag" href="/tags/it-basic/">IT-Basic</a> <a class="post-tag" href="/tags/think/">Think</a> <a class="post-tag" href="/tags/vim/">Vim</a></div></div></div><script> (function() { $("#content-list").click(function(event){ var e=window.event || event; if(e.stopPropagation){ e.stopPropagation(); }else{ e.cancelBubble = true; } if($('#markdown-toc').is(':hidden')){ $('#markdown-toc').show(); }else{ $('#markdown-toc').hide(); } }); $("#markdown-toc").click(function(event){ var e=window.event || event; if(e.stopPropagation){ e.stopPropagation(); }else{ e.cancelBubble = true; } }); $(document).click(function(event) { $("#markdown-toc").hide(); }); }()); </script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"><ul class="nav navbar-nav"><li><a href="#获取帮助" class="nav-link">获取帮助</a><li><a href="#初始化-git-项目" class="nav-link">初始化 git 项目</a><ul class="nav navbar-nav"><li><a href="#设置常用配置" class="nav-link">设置常用配置</a><li><a href="#项目初始化" class="nav-link">项目初始化</a></ul><li><a href="#修改了些什么" class="nav-link">修改了些什么？</a><ul class="nav navbar-nav"><li><a href="#提交前改了啥" class="nav-link">提交前改了啥</a><li><a href="#提交之后的某个版本改了啥" class="nav-link">提交之后的某个版本改了啥</a><li><a href="#分支合并前改了啥" class="nav-link">分支合并前改了啥</a><li><a href="#丢弃修改" class="nav-link">丢弃修改</a></ul><li><a href="#优化提交记录" class="nav-link">优化提交记录</a><ul class="nav navbar-nav"><li><a href="#修改注释信息" class="nav-link">修改注释信息</a><li><a href="#合并提交记录" class="nav-link">合并提交记录</a></ul><li><a href="#多分支处理" class="nav-link">多分支处理</a><ul class="nav navbar-nav"><li><a href="#打补丁" class="nav-link">打补丁</a><ul class="nav navbar-nav"><li><a href="#合并部分文件" class="nav-link">合并部分文件</a><li><a href="#分支打补丁" class="nav-link">分支打补丁</a></ul><li><a href="#合并分支" class="nav-link">合并分支</a><li><a href="#新建分支" class="nav-link">新建分支</a><ul class="nav navbar-nav"><li><a href="#新建本地分支" class="nav-link">新建本地分支：</a><li><a href="#新建远程分支" class="nav-link">新建远程分支</a></ul><li><a href="#查看分支" class="nav-link">查看分支</a><li><a href="#删除或更新分支" class="nav-link">删除或更新分支</a><li><a href="#切换分支" class="nav-link">切换分支</a><li><a href="#打-tag" class="nav-link">打 tag</a></ul><li><a href="#其他" class="nav-link">其他</a><li><a href="#want-cmm" class="nav-link"> 我要评论 </a></ul></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/2022/04/git-jump.html"><div class="card-body"> <em class="small" data-ts="1648984308" data-df="YYYY/MM/DD" > 2022/04/03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>git 高手跃迁</h3><div class="text-muted small"><p> 本文试图从应用和原理及设计层层多角度探究 git，帮助读者相对全面透彻的理解 git，并能 随心所欲高效地使用 git 俯视 git 基本流程 基本概念 应用层面的概念 底层概念 git 存储快照是不是很低效 图解 git 的...</p></div></div></a></div><div class="card"> <a href="/2022/05/text-draw-uml.html"><div class="card-body"> <em class="small" data-ts="1652799499" data-df="YYYY/MM/DD" > 2022/05/17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>画图，简单到无法拒绝</h3><div class="text-muted small"><p> 本文介绍一种通过文本代码来画常用图的方法，包括脑图、UML图、原型界面等。 只需要一个链接就可以展示图、修改图、随时随地传送图等，可以消除常常忘记可编辑 原图的文件在哪里、不便修改、图中内容不可复制、不可重定向等各种烦恼。 工具简介 想法落地流 图模板 使用方法 模板 脑图(思维导图) ...</p></div></div></a></div><div class="card"> <a href="/2022/06/docker.html"><div class="card-body"> <em class="small" data-ts="1655622499" data-df="YYYY/MM/DD" > 2022/06/19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>docker 精要</h3><div class="text-muted small"><p> docker 在开发、测试、部署和微服务治理、PaaS（平台即服务）以及云原生或云计算等领域已举足轻重。本文将简要探讨 一下 docker，主要从使用角度（而非源代码角度）的各个层面呈现其功能的强大和设计上的魅力。 远观 docker docker 容器集群编排工具 DockerFile docker compose Docke...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/2017/12/cpp-code-standard.html" class="btn btn-outline-primary" prompt="上一篇"><p>C++ 编程规范</p></a> <a href="/2021/07/foundation-of-algorithm.html" class="btn btn-outline-primary" prompt="下一篇"><p>算法基石</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cpp/">Cpp</a> <a class="post-tag" href="/tags/it-basic/">IT_Basic</a> <a class="post-tag" href="/tags/tool/">Tool</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/go/">Go</a> <a class="post-tag" href="/tags/it-basic/">IT-Basic</a> <a class="post-tag" href="/tags/think/">Think</a> <a class="post-tag" href="/tags/vim/">Vim</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/code-winder">code-winder</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div style="text-align:center;width: 90%;"><p class="mb-0"> 总访问量 <span id="busuanzi_value_site_pv" style="color: blue;"></span> ，访客数 <span id="busuanzi_value_site_uv" style="color: blue;"></span> ，本文总阅读量 <span id="busuanzi_value_page_pv" style="color: blue;"> </span></p></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="footer-right"><p class="mb-0">本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">发现新版本的内容。</p><button type="button" class="btn btn-primary" aria-label="Update"> 更新 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/zh.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-72449510-4"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-72449510-4'); }); </script>
